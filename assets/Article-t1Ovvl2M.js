import{a as $,i as A,j as e,T as p,R as S,J as H,c as Q,m as W,B as d,F as oe,O as ce,Q as F,G as n,r as o,u as de,K as ue,d as me,C as pe,H as xe,P as he,M as je}from"./index-u-5LU58q.js";import{c as G,D as fe,a as _e,b as ve,d as ge}from"./ArrowForwardIos-AFa3LoKk.js";import{b as be,C as Ce,a as M}from"./CardHeader-yuuaLDa1.js";import{C as ye}from"./CardMedia-CQS6SsB8.js";import{L as Ne}from"./LinearProgress-VRHIXvVH.js";var R={},Se=A;Object.defineProperty(R,"__esModule",{value:!0});var w=R.default=void 0,$e=Se($()),Ae=e,Te=(0,$e.default)((0,Ae.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");w=R.default=Te;var z={},ke=A;Object.defineProperty(z,"__esModule",{value:!0});var L=z.default=void 0,Me=ke($()),Re=e,ze=(0,Me.default)((0,Re.jsx)("path",{d:"M11.07 12.85c.77-1.39 2.25-2.21 3.11-3.44.91-1.29.4-3.7-2.18-3.7-1.69 0-2.52 1.28-2.87 2.34L6.54 6.96C7.25 4.83 9.18 3 11.99 3c2.35 0 3.96 1.07 4.78 2.41.7 1.15 1.11 3.3.03 4.9-1.2 1.77-2.35 2.31-2.97 3.45-.25.46-.35.76-.35 2.24h-2.89c-.01-.78-.13-2.05.48-3.15zM14 20c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2z"}),"QuestionMark");L=z.default=ze;var I={},Ie=A;Object.defineProperty(I,"__esModule",{value:!0});var V=I.default=void 0,qe=Ie($()),De=e,Ee=(0,qe.default)((0,De.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");V=I.default=Ee;var q={},Pe=A;Object.defineProperty(q,"__esModule",{value:!0});var J=q.default=void 0,Oe=Pe($()),Be=e,Fe=(0,Oe.default)((0,Be.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");J=q.default=Fe;const K=l=>{let x=`Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in
                voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat
                non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.`;if(l){if(typeof l=="object"&&l.length>0)return l.map((c,s)=>e.jsx(p,{className:c.type&&c.type==="title"?"title":"text",variant:c.type&&c.type==="title"?"h6":"body1",children:c.text},s));if(typeof l=="string")return e.jsx(p,{children:l})}else return e.jsx(p,{children:x})},Ge=({content:l,title:x,subArticleIndex:c,done:s})=>{const[h,X]=S.useState(!1),[u,v]=S.useState(!1),j=()=>{v(!1)},{selectedArticle:T}=H(),f=Q(),g=()=>{f(`/test/${T}/${c}`)};return e.jsxs(S.Fragment,{children:[e.jsxs(be,{elevation:s?6:0,className:"subtopics_card",children:[e.jsx(Ce,{avatar:s?e.jsx(V,{}):e.jsx(J,{}),titleTypographyProps:{variant:"h5"},title:x}),e.jsx(ye,{component:"img",image:W,alt:"myImage"}),e.jsxs("div",{className:"hover_container",children:[" ",!h&&!s&&e.jsx(M,{disableSpacing:!0,children:e.jsx(d,{color:"secondary",onClick:()=>v(!0),endIcon:e.jsx(L,{}),"aria-expanded":h,size:"small",fullWidth:!0,variant:"contained",className:"learn-more-button",children:"Дізнатися більше"})}),s?null:e.jsx(M,{disableSpacing:!0,children:e.jsx(d,{onClick:g,endIcon:e.jsx(G,{}),color:"secondary",size:"small",fullWidth:!0,variant:"outlined",className:"goToTest",children:"Пройти тест"})})]}),h&&e.jsx(M,{disableSpacing:!0,children:e.jsx(d,{onClick:()=>v(!0),endIcon:e.jsx(w,{}),color:"secondary","aria-expanded":h,size:"small",fullWidth:!0,variant:"contained",className:"learn-more-button",children:"Згорнути"})})]}),e.jsxs(oe,{className:"modal_with_sub_article_info",fullWidth:!0,open:u,onClose:j,children:[e.jsx(fe,{variant:"h4",id:"customized-dialog-title",children:x}),e.jsx(ce,{"aria-label":"close",onClick:j,sx:{position:"absolute",right:8,top:8,color:b=>b.palette.grey[500]},children:e.jsx(F,{})}),e.jsx(_e,{children:K(l)}),e.jsx(ve,{children:e.jsxs(n,{container:!0,spacing:2,justifyContent:"end",children:[e.jsx(n,{item:!0,xs:"auto",children:e.jsx(d,{onClick:g,endIcon:e.jsx(G,{}),color:"primary",size:"medium",variant:"contained",className:"goToTest",children:"Пройти тест"})}),e.jsx(n,{item:!0,xs:"auto",children:e.jsx(d,{onClick:j,endIcon:e.jsx(F,{}),color:"secondary",size:"medium",variant:"outlined",children:"Close"})})]})})]})]})},Ve=({setSelectedArticle:l,subArticleSuccessLevels:x,setSelectedSubArticle:c,historyList:s,isLoading:h,articleContentFromApp:X,currentUser:u})=>{const{selectedArticle:v}=H(),[j,T]=o.useState(null);o.useState([]);const[f,g]=o.useState([]),[b,Y]=o.useState(0),[Z,U]=o.useState(0),[ee,te]=o.useState(0),[C,se]=o.useState(!1);x=[];const y=Q(),r=parseInt(v||"0",10);o.useEffect(()=>{se(u.current_level>r)},[r,u]),o.useEffect(()=>{var i,m;l(r);const t=(i=s[r])==null?void 0:i.subtopics;g(t??[]);const a=(m=s[r])==null?void 0:m.content;T(typeof a=="object"?a:null)},[r]);const D=()=>{debugger;y(`/test/${r}`)},k=s[r],ae=de(),ne=ue(ae.breakpoints.up("md")),{isAuthenticated:E}=me();o.useEffect(()=>{E||y("/")},[E]);const P=t=>{y(`/test/${t}`),l(t)},re=(t,a)=>{debugger;y(`/test/${t}/${a}`),l(t),c(a)},ie=t=>{if(!s||r===void 0||r<0||r>=s.length)return;const a=s[r];if(a.subtopics&&a.subtopics.length>0){const i=a.subtopics.findIndex((m,_)=>{var N;return!((N=x[t])!=null&&N[_])});i!==-1?re(t,i):P(t)}else P(t)};o.useEffect(()=>{if(!s||r>=s.length)return;const t=s[r];if(t&&t.subtopics){const a=t.subtopics,i=a.length,m=a.reduce((_,N)=>{const B=u.tests_completed_list.find(le=>le.test_id===N.sub_article_test_id);return B&&B.completed&&(_+=1),_},0);te(i),U(m),Y(i>0?m/i*100:0)}},[s,r,u.tests_completed_list]);const O=f.length>0&&!f.every(t=>{const a=u.tests_completed_list.find(i=>i.test_id===t.sub_article_test_id);return a&&a.completed});return e.jsxs(pe,{className:"article_page_container",children:[e.jsx(xe,{children:e.jsxs("title",{children:[" ",h?"Loading":`Тема ${k.text}`]})}),h?e.jsx(he,{}):e.jsxs(S.Fragment,{children:[e.jsx(n,{className:"back_button_container",container:!0,children:e.jsx(n,{item:!0,children:e.jsx(d,{component:je,to:"/timeline",color:"secondary",startIcon:e.jsx(ge,{}),className:"close-button",children:"До Часопростору"})})}),e.jsx(p,{textAlign:"center",variant:"h6",className:"lesson",children:"Lesson"}),e.jsx(p,{textAlign:"center",className:"date",variant:"h5",children:k.date}),e.jsx(p,{textAlign:"center",className:"title",variant:"h4",children:k.text}),e.jsx(n,{container:!0,justifyContent:"center",children:e.jsx(n,{item:!0,xs:"auto",children:!C&&(O?e.jsx(d,{className:"start_button_top",onClick:()=>ie(r),variant:"contained",children:"Start Test"}):e.jsx(d,{className:"start_button_top",onClick:D,variant:"contained",children:"Start Test"}))})}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsxs(n,{item:!0,xs:12,md:5,children:[" ",e.jsx("img",{src:W,alt:""})]}),e.jsx(n,{item:!0,xs:12,md:7,children:e.jsx("div",{className:"content_container",children:s[r].content&&K(j||"")})})]}),f.length>0&&e.jsxs(n,{className:"subtopic_card_list",container:!0,justifyContent:"center",children:[!C&&e.jsx(n,{item:!0,xs:12,sm:12,md:6,xl:6,children:e.jsx(p,{variant:"h6",children:"Пройдіть додаткові завдання перед головним тестом"})}),!C&&e.jsx(n,{className:"additional_test_progress_container",container:!0,justifyContent:"center",children:e.jsxs(n,{item:!0,xs:12,sm:8,md:6,xl:4,children:[e.jsx(Ne,{color:"primary",variant:"determinate",value:b}),e.jsxs(p,{className:"linear_progress_title",variant:"body2",gutterBottom:!0,children:["Виконано: ",Z," із ",ee," (",b.toFixed(2),"%)"]})]})}),e.jsxs(n,{item:!0,container:!0,xs:12,spacing:2,children:[f.map((t,a)=>{const i=u.tests_completed_list.find(_=>_.test_id===t.sub_article_test_id),m=i?i.completed:!1;return e.jsx(n,{item:!0,xs:12,sm:6,md:4,xl:3,children:e.jsx(Ge,{done:m,subArticleIndex:a,title:t.title,content:t.content})},a+"card")}),"                                "]})]}),!C&&e.jsx(n,{container:!0,justifyContent:"center",children:e.jsx(n,{item:!0,xs:12,sm:6,md:"auto",children:e.jsx(d,{disabled:O,size:"large",fullWidth:!ne,variant:"contained",className:"quiz-button",onClick:D,children:"Завершити рівень"})})})]})]})};export{Ve as default};
