import{a as $,i as A,j as e,R as S,J as H,c as Q,m as W,B as i,F as ie,O as ce,Q as F,V as w,G as a,r as o,u as de,K as ue,d as me,C as xe,H as pe,P as je,M as he,T as _}from"./index-qWc-udNQ.js";import{c as G,D as fe,a as _e,b as ve,d as ge}from"./ArrowForwardIos-YqiWkjZt.js";import{b as be,C as Ce,a as M}from"./CardHeader-9JgTBfo5.js";import{C as Ne}from"./CardMedia-ZoIm_lRP.js";import{L as Se}from"./LinearProgress-qajB1DxA.js";var R={},$e=A;Object.defineProperty(R,"__esModule",{value:!0});var V=R.default=void 0,Ae=$e($()),Te=e,ke=(0,Ae.default)((0,Te.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");V=R.default=ke;var z={},ye=A;Object.defineProperty(z,"__esModule",{value:!0});var J=z.default=void 0,Me=ye($()),Re=e,ze=(0,Me.default)((0,Re.jsx)("path",{d:"M11.07 12.85c.77-1.39 2.25-2.21 3.11-3.44.91-1.29.4-3.7-2.18-3.7-1.69 0-2.52 1.28-2.87 2.34L6.54 6.96C7.25 4.83 9.18 3 11.99 3c2.35 0 3.96 1.07 4.78 2.41.7 1.15 1.11 3.3.03 4.9-1.2 1.77-2.35 2.31-2.97 3.45-.25.46-.35.76-.35 2.24h-2.89c-.01-.78-.13-2.05.48-3.15zM14 20c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2z"}),"QuestionMark");J=z.default=ze;var I={},Ie=A;Object.defineProperty(I,"__esModule",{value:!0});var K=I.default=void 0,Pe=Ie($()),De=e,Ee=(0,Pe.default)((0,De.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");K=I.default=Ee;var P={},Oe=A;Object.defineProperty(P,"__esModule",{value:!0});var L=P.default=void 0,Be=Oe($()),qe=e,Fe=(0,Be.default)((0,qe.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");L=P.default=Fe;const Ge=({content:j,title:h,subArticleIndex:T,done:r})=>{const[u,X]=S.useState(!1),[c,f]=S.useState(!1),m=()=>{f(!1)},{selectedArticle:k}=H(),x=Q(),v=()=>{x(`/test/${k}/${T}`)};return e.jsxs(S.Fragment,{children:[e.jsxs(be,{elevation:r?6:0,className:"subtopics_card",children:[e.jsx(Ce,{avatar:r?e.jsx(K,{}):e.jsx(L,{}),titleTypographyProps:{variant:"h5"},title:h}),e.jsx(Ne,{component:"img",image:W,alt:"myImage"}),e.jsxs("div",{className:"hover_container",children:[" ",!u&&!r&&e.jsx(M,{disableSpacing:!0,children:e.jsx(i,{color:"secondary",onClick:()=>f(!0),endIcon:e.jsx(J,{}),"aria-expanded":u,size:"small",fullWidth:!0,variant:"contained",className:"learn-more-button",children:"Дізнатися більше"})}),r?null:e.jsx(M,{disableSpacing:!0,children:e.jsx(i,{onClick:v,endIcon:e.jsx(G,{}),color:"secondary",size:"small",fullWidth:!0,variant:"outlined",className:"goToTest",children:"Пройти тест"})})]}),u&&e.jsx(M,{disableSpacing:!0,children:e.jsx(i,{onClick:()=>f(!0),endIcon:e.jsx(V,{}),color:"secondary","aria-expanded":u,size:"small",fullWidth:!0,variant:"contained",className:"learn-more-button",children:"Згорнути"})})]}),e.jsxs(ie,{className:"modal_with_sub_article_info",fullWidth:!0,open:c,onClose:m,children:[e.jsx(fe,{variant:"h4",id:"customized-dialog-title",children:h}),e.jsx(ce,{"aria-label":"close",onClick:m,sx:{position:"absolute",right:8,top:8,color:g=>g.palette.grey[500]},children:e.jsx(F,{})}),e.jsx(_e,{children:w(j)}),e.jsx(ve,{children:e.jsxs(a,{container:!0,spacing:2,justifyContent:"end",children:[e.jsx(a,{item:!0,xs:"auto",children:e.jsx(i,{onClick:v,endIcon:e.jsx(G,{}),color:"primary",size:"medium",variant:"contained",className:"goToTest",children:"Пройти тест"})}),e.jsx(a,{item:!0,xs:"auto",children:e.jsx(i,{onClick:m,endIcon:e.jsx(F,{}),color:"secondary",size:"medium",variant:"outlined",children:"Close"})})]})})]})]})},Je=({setSelectedArticle:j,subArticleSuccessLevels:h,setSelectedSubArticle:T,historyList:r,isLoading:u,articleContentFromApp:X,currentUser:c})=>{const{selectedArticle:f}=H(),[m,k]=o.useState(null);o.useState([]);const[x,v]=o.useState([]),[g,Y]=o.useState(0),[Z,U]=o.useState(0),[ee,te]=o.useState(0),[b,se]=o.useState(!1);h=[];const C=Q(),n=parseInt(f||"0",10);o.useEffect(()=>{se(c.current_level>n)},[n,c]),o.useEffect(()=>{var l,d;j(n);const t=(l=r[n])==null?void 0:l.subtopics;v(t??[]);const s=(d=r[n])==null?void 0:d.content;k(typeof s=="object"?s:null)},[n]);const D=()=>{debugger;C(`/test/${n}`)},y=r[n],ae=de(),ne=ue(ae.breakpoints.up("md")),{isAuthenticated:E}=me();o.useEffect(()=>{E||C("/")},[E]);const O=t=>{C(`/test/${t}`),j(t)},re=(t,s)=>{debugger;C(`/test/${t}/${s}`),j(t),T(s)},le=t=>{if(!r||n===void 0||n<0||n>=r.length)return;const s=r[n];if(s.subtopics&&s.subtopics.length>0){const l=s.subtopics.findIndex((d,p)=>{var N;return!((N=h[t])!=null&&N[p])});l!==-1?re(t,l):O(t)}else O(t)};o.useEffect(()=>{if(!r||n>=r.length)return;const t=r[n];if(t&&t.subtopics){const s=t.subtopics,l=s.length,d=s.reduce((p,N)=>{const q=c.tests_completed_list.find(oe=>oe.test_id===N.sub_article_test_id);return q&&q.completed&&(p+=1),p},0);te(l),U(d),Y(l>0?d/l*100:0)}},[r,n,c.tests_completed_list]);const B=x.length>0&&!x.every(t=>{const s=c.tests_completed_list.find(l=>l.test_id===t.sub_article_test_id);return s&&s.completed});return e.jsxs(xe,{className:"article_page_container",children:[e.jsx(pe,{children:e.jsxs("title",{children:[" ",u?"Loading":`Тема ${y.text}`]})}),u?e.jsx(je,{}):e.jsxs(S.Fragment,{children:[e.jsx(a,{className:"back_button_container",container:!0,children:e.jsx(a,{item:!0,children:e.jsx(i,{component:he,to:"/timeline",color:"secondary",startIcon:e.jsx(ge,{}),className:"close-button",children:"До Часопростору"})})}),e.jsx(_,{textAlign:"center",variant:"h6",className:"lesson",children:"Lesson"}),e.jsx(_,{textAlign:"center",className:"date",variant:"h5",children:y.date}),e.jsx(_,{textAlign:"center",className:"title",variant:"h4",children:y.text}),e.jsx(a,{container:!0,justifyContent:"center",children:e.jsx(a,{item:!0,xs:"auto",children:!b&&(B?e.jsx(i,{className:"start_button_top",onClick:()=>le(n),variant:"contained",children:"Start Test"}):e.jsx(i,{className:"start_button_top",onClick:D,variant:"contained",children:"Start Test"}))})}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{item:!0,xs:12,md:5,children:[" ",e.jsx("img",{src:W,alt:""})]}),e.jsx(a,{item:!0,xs:12,md:7,children:e.jsx("div",{className:"content_container",children:r[n].content&&w(m||"")})})]}),x.length>0&&e.jsxs(a,{className:"subtopic_card_list",container:!0,justifyContent:"center",children:[!b&&e.jsx(a,{item:!0,xs:12,sm:12,md:6,xl:6,children:e.jsx(_,{variant:"h6",children:"Пройдіть додаткові завдання перед головним тестом"})}),!b&&e.jsx(a,{className:"additional_test_progress_container",container:!0,justifyContent:"center",children:e.jsxs(a,{item:!0,xs:12,sm:8,md:6,xl:4,children:[e.jsx(Se,{color:"primary",variant:"determinate",value:g}),e.jsxs(_,{className:"linear_progress_title",variant:"body2",gutterBottom:!0,children:["Виконано: ",Z," із ",ee," (",g.toFixed(2),"%)"]})]})}),e.jsxs(a,{item:!0,container:!0,xs:12,spacing:2,children:[x.map((t,s)=>{const l=c.tests_completed_list.find(p=>p.test_id===t.sub_article_test_id),d=l?l.completed:!1;return e.jsx(a,{item:!0,xs:12,sm:6,md:4,xl:3,children:e.jsx(Ge,{done:d,subArticleIndex:s,title:t.title,content:t.content})},s+"card")}),"                                "]})]}),!b&&e.jsx(a,{container:!0,justifyContent:"center",children:e.jsx(a,{item:!0,xs:12,sm:6,md:"auto",children:e.jsx(i,{disabled:B,size:"large",fullWidth:!ne,variant:"contained",className:"quiz-button",onClick:D,children:"Завершити рівень"})})})]})]})};export{Je as default};
