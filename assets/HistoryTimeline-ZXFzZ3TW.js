import{r as b,g as he,a as ee,i as te,j as u,u as ve,R as W,m as ge,T as D,B as F,b as be,U as _e,c as ye,d as Te,C as xe,H as Ce,P as Oe}from"./index-1B96ieGc.js";import{C as Se,a as je,b as we}from"./CardHeader-erOQvMz9.js";import{C as Ve}from"./CardMedia-63FKT6tt.js";import{H as Ne}from"./Hidden-6XRNCBm5.js";import{C as Re}from"./CardContent-QHXOgstt.js";import{L as ke}from"./LinearProgress-7cFrtWy8.js";var re={exports:{}},Ee="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ie=Ee,Me=Ie;function ne(){}function ie(){}ie.resetWarningCache=ne;var Pe=function(){function e(i,t,a,d,l,o){if(o!==Me){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}e.isRequired=e;function r(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:ie,resetWarningCache:ne};return n.PropTypes=n,n};re.exports=Pe();var ae=re.exports,P={},oe={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var r={}.hasOwnProperty;function n(){for(var i=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var d=typeof a;if(d==="string"||d==="number")i.push(a);else if(Array.isArray(a)){if(a.length){var l=n.apply(null,a);l&&i.push(l)}}else if(d==="object"){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){i.push(a.toString());continue}for(var o in a)r.call(a,o)&&a[o]&&i.push(o)}}}return i.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(oe);var se=oe.exports;P.__esModule=!0;P.default=void 0;var $e=B(b),C=B(ae),Ae=B(se);function B(e){return e&&e.__esModule?e:{default:e}}const le=({animate:e=!0,className:r="",layout:n="2-columns",lineColor:i="#FFF",children:t})=>(typeof window=="object"&&document.documentElement.style.setProperty("--line-color",i),$e.default.createElement("div",{className:(0,Ae.default)(r,"vertical-timeline",{"vertical-timeline--animate":e,"vertical-timeline--two-columns":n==="2-columns","vertical-timeline--one-column-left":n==="1-column"||n==="1-column-left","vertical-timeline--one-column-right":n==="1-column-right"})},t));le.propTypes={children:C.default.oneOfType([C.default.arrayOf(C.default.node),C.default.node]).isRequired,className:C.default.string,animate:C.default.bool,layout:C.default.oneOf(["1-column-left","1-column","2-columns","1-column-right"]),lineColor:C.default.string};var Fe=le;P.default=Fe;var $={};function z(){return z=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},z.apply(this,arguments)}function We(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,U(e,r)}function U(e,r){return U=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},U(e,r)}function De(e,r){if(e==null)return{};var n={},i=Object.keys(e),t,a;for(a=0;a<i.length;a++)t=i[a],!(r.indexOf(t)>=0)&&(n[t]=e[t]);return n}var q=new Map,E=new WeakMap,X=0,ce=void 0;function ze(e){ce=e}function Ue(e){return e?(E.has(e)||(X+=1,E.set(e,X.toString())),E.get(e)):"0"}function qe(e){return Object.keys(e).sort().filter(function(r){return e[r]!==void 0}).map(function(r){return r+"_"+(r==="root"?Ue(e.root):e[r])}).toString()}function Be(e){var r=qe(e),n=q.get(r);if(!n){var i=new Map,t,a=new IntersectionObserver(function(d){d.forEach(function(l){var o,s=l.isIntersecting&&t.some(function(m){return l.intersectionRatio>=m});e.trackVisibility&&typeof l.isVisible>"u"&&(l.isVisible=s),(o=i.get(l.target))==null||o.forEach(function(m){m(s,l)})})},e);t=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:r,observer:a,elements:i},q.set(r,n)}return n}function H(e,r,n,i){if(n===void 0&&(n={}),i===void 0&&(i=ce),typeof window.IntersectionObserver>"u"&&i!==void 0){var t=e.getBoundingClientRect();return r(i,{isIntersecting:i,target:e,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:t,intersectionRect:t,rootBounds:t}),function(){}}var a=Be(n),d=a.id,l=a.observer,o=a.elements,s=o.get(e)||[];return o.has(e)||o.set(e,s),s.push(r),l.observe(e),function(){s.splice(s.indexOf(r),1),s.length===0&&(o.delete(e),l.unobserve(e)),o.size===0&&(l.disconnect(),q.delete(d))}}var He=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function Z(e){return typeof e.children!="function"}var M=function(e){We(r,e);function r(i){var t;return t=e.call(this,i)||this,t.node=null,t._unobserveCb=null,t.handleNode=function(a){t.node&&(t.unobserve(),!a&&!t.props.triggerOnce&&!t.props.skip&&t.setState({inView:!!t.props.initialInView,entry:void 0})),t.node=a||null,t.observeNode()},t.handleChange=function(a,d){a&&t.props.triggerOnce&&t.unobserve(),Z(t.props)||t.setState({inView:a,entry:d}),t.props.onChange&&t.props.onChange(a,d)},t.state={inView:!!i.initialInView,entry:void 0},t}var n=r.prototype;return n.componentDidUpdate=function(t){(t.rootMargin!==this.props.rootMargin||t.root!==this.props.root||t.threshold!==this.props.threshold||t.skip!==this.props.skip||t.trackVisibility!==this.props.trackVisibility||t.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())},n.componentWillUnmount=function(){this.unobserve(),this.node=null},n.observeNode=function(){if(!(!this.node||this.props.skip)){var t=this.props,a=t.threshold,d=t.root,l=t.rootMargin,o=t.trackVisibility,s=t.delay,m=t.fallbackInView;this._unobserveCb=H(this.node,this.handleChange,{threshold:a,root:d,rootMargin:l,trackVisibility:o,delay:s},m)}},n.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},n.render=function(){if(!Z(this.props)){var t=this.state,a=t.inView,d=t.entry;return this.props.children({inView:a,entry:d,ref:this.handleNode})}var l=this.props,o=l.children,s=l.as,m=De(l,He);return b.createElement(s||"div",z({ref:this.handleNode},m),o)},r}(b.Component);M.displayName="InView";M.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};function Ge(e){var r=e===void 0?{}:e,n=r.threshold,i=r.delay,t=r.trackVisibility,a=r.rootMargin,d=r.root,l=r.triggerOnce,o=r.skip,s=r.initialInView,m=r.fallbackInView,h=b.useRef(),y=b.useState({inView:!!s}),g=y[0],_=y[1],j=b.useCallback(function(x){h.current!==void 0&&(h.current(),h.current=void 0),!o&&x&&(h.current=H(x,function(V,k){_({inView:V,entry:k}),k.isIntersecting&&l&&h.current&&(h.current(),h.current=void 0)},{root:d,rootMargin:a,threshold:n,trackVisibility:t,delay:i},m))},[Array.isArray(n)?n.toString():n,d,a,l,o,t,m,i]);b.useEffect(function(){!h.current&&g.entry&&!l&&!o&&_({inView:!!s})});var v=[j,g.inView,g.entry];return v.ref=v[0],v.inView=v[1],v.entry=v[2],v}const Ke=Object.freeze(Object.defineProperty({__proto__:null,InView:M,default:M,defaultFallbackInView:ze,observe:H,useInView:Ge},Symbol.toStringTag,{value:"Module"})),Ye=he(Ke);$.__esModule=!0;$.default=void 0;var O=G(b),p=G(ae),I=G(se),Je=Ye;function G(e){return e&&e.__esModule?e:{default:e}}const ue=({children:e="",className:r="",contentArrowStyle:n=null,contentStyle:i=null,date:t="",dateClassName:a="",icon:d=null,iconClassName:l="",iconOnClick:o=null,onTimelineElementClick:s=null,iconStyle:m=null,id:h="",position:y="",style:g=null,textClassName:_="",intersectionObserverProps:j={rootMargin:"0px 0px -40px 0px",triggerOnce:!0},visible:v=!1})=>O.default.createElement(Je.InView,j,({inView:x,ref:V})=>O.default.createElement("div",{ref:V,id:h,className:(0,I.default)(r,"vertical-timeline-element",{"vertical-timeline-element--left":y==="left","vertical-timeline-element--right":y==="right","vertical-timeline-element--no-children":e===""}),style:g},O.default.createElement(O.default.Fragment,null,O.default.createElement("span",{style:m,onClick:o,className:(0,I.default)(l,"vertical-timeline-element-icon",{"bounce-in":x||v,"is-hidden":!(x||v)})},d),O.default.createElement("div",{style:i,onClick:s,className:(0,I.default)(_,"vertical-timeline-element-content",{"bounce-in":x||v,"is-hidden":!(x||v)})},O.default.createElement("div",{style:n,className:"vertical-timeline-element-content-arrow"}),e,O.default.createElement("span",{className:(0,I.default)(a,"vertical-timeline-element-date")},t)))));ue.propTypes={children:p.default.oneOfType([p.default.arrayOf(p.default.node),p.default.node]),className:p.default.string,contentArrowStyle:p.default.shape({}),contentStyle:p.default.shape({}),date:p.default.node,dateClassName:p.default.string,icon:p.default.element,iconClassName:p.default.string,iconStyle:p.default.shape({}),iconOnClick:p.default.func,onTimelineElementClick:p.default.func,id:p.default.string,position:p.default.string,style:p.default.shape({}),textClassName:p.default.string,visible:p.default.bool,intersectionObserverProps:p.default.shape({root:p.default.object,rootMargin:p.default.string,threshold:p.default.number,triggerOnce:p.default.bool})};var Qe=ue;$.default=Qe;var L={VerticalTimeline:P.default,VerticalTimelineElement:$.default},K={},Xe=te;Object.defineProperty(K,"__esModule",{value:!0});var de=K.default=void 0,Ze=Xe(ee()),Le=u,et=(0,Ze.default)((0,Le.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUncheckedRounded");de=K.default=et;var Y={},tt=te;Object.defineProperty(Y,"__esModule",{value:!0});var fe=Y.default=void 0,rt=tt(ee()),nt=u,it=(0,rt.default)((0,nt.jsx)("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"CheckCircleOutline");fe=Y.default=it;const at=({event:e,index:r,buttonState:n,handleExpandArticle:i,handleGoToTestNow:t,handleGoToSubArticleTest:a,successLevel:d,isAllSubtaskDone:l,totalSubtopics:o,completedSubtopics:s})=>{const m=ve(),h=d<r,y=h?m.palette.text.disabled:m.palette.text.primary,g=o>0?s/o*100:0;return u.jsxs(W.Fragment,{children:[u.jsx(Se,{titleTypographyProps:{color:y},title:e.date}),u.jsx(Ve,{className:h?"imageOpacity":"",component:"img",height:"194",image:ge,alt:"city"}),u.jsx(Ne,{smDown:!0,children:u.jsx(Re,{children:u.jsx(D,{color:y,component:"div",children:e.text})})}),u.jsxs(je,{disableSpacing:!0,sx:{flexWrap:"wrap"},children:[u.jsx(F,{variant:"outlined",color:"secondary",size:"small",sx:{mb:1},fullWidth:!0,disabled:h,className:"learn-more-button",onClick:_=>{_.stopPropagation(),i(r)},children:"Дізнатися більше"}),d===r&&(l?u.jsx(F,{size:"large",variant:"contained",fullWidth:!0,disabled:h,className:"goToTest",onClick:_=>{_.stopPropagation(),t(r)},children:"Завершити рівень"}):u.jsxs(W.Fragment,{children:[u.jsxs("div",{className:"progress_bar_container",children:[u.jsx(ke,{color:"primary",variant:"determinate",value:g}),u.jsxs(D,{variant:"body2",gutterBottom:!0,children:["Виконано: ",s," із ",o," (",g.toFixed(2),"%)"]})]}),u.jsx(F,{size:"large",variant:"contained",fullWidth:!0,className:"goToTest",onClick:_=>{_.stopPropagation(),a(r)},children:"Пройти завдання"})]}))]})]})},ft=({historyList:e,buttonStates:r,successLevels:n,setSelectedArticle:i,selectedArticle:t,subArticleSuccessLevels:a,setSelectedSubArticle:d,isLoading:l})=>{const o=be(),{currentUser:s}=b.useContext(_e),[m,h]=b.useState(null),y=f=>f?o.palette.primary.contrastText:o.palette.primary.main,g=ye(),_=f=>{i(f),g(`/article/${f}`)},j=f=>{debugger;g(`/test/${f}`),i(f)},v=(f,c)=>{debugger;g(`/test/${f}/${c}`),i(f),d(c)};b.useEffect(()=>{e&&h(e[t].subtopics)},[t,e]);const x=f=>{var Q;if(s===null)return!1;let c=s.tests_completed_list;if(!c){console.error("User tests_completed_list is not available.");return}const T=c.find(R=>R.test_type==="Sub Article"&&R.event_id===f+1&&!R.completed);if(!T){console.error("No incomplete test found.");return}const S=(Q=e[f])==null?void 0:Q.subtopics;if(!S){console.error("SubArticle is not available.");return}const w=R=>S.findIndex(me=>me.sub_article_test_id===R),N=T.test_id,A=w(N);i(f),v(f,A)},V=f=>{const c=e[f];return!c||!c.subtopics?0:c.subtopics.reduce((T,S)=>{const w=s==null?void 0:s.tests_completed_list;let N;return w&&(N=w.find(A=>A.test_id===S.sub_article_test_id)),N&&N.completed?T+1:T},0)};b.useEffect(()=>{m&&m.length>0&&m.findIndex((f,c)=>{var T;return!((T=a[t])!=null&&T[c])})},[m,a,t,v,j]);const k=f=>{const c=e[f];return!c||!s||!c.subtopics?!1:c.subtopics.every(T=>{const S=s.tests_completed_list.find(w=>w.test_id===T.sub_article_test_id);return S&&S.completed})},pe=f=>{const c=e[f];return c&&c.subtopics?c.subtopics.length:0},{isAuthenticated:J}=Te();return b.useEffect(()=>{J||g("/")},[J]),u.jsxs(xe,{className:"history_timeline_page",children:[u.jsx(Ce,{children:u.jsx("title",{children:"Часопростір"})}),u.jsx(D,{className:"main_title",textAlign:"center",component:"h1",variant:"h3",children:"Часопростір"}),u.jsx(L.VerticalTimeline,{lineColor:o.palette.primary.light,children:l?u.jsx(Oe,{}):e&&e.length>0?e.map((f,c)=>u.jsx(W.Fragment,{children:u.jsx(L.VerticalTimelineElement,{dateClassName:"hidden",className:n===c?"current_active_vertical_timeline_element":"",iconStyle:{background:o.palette.primary.light,color:y(n>c)},contentStyle:{padding:0,boxShadow:"none"},icon:n===c+1?u.jsx(fe,{}):u.jsx(de,{}),children:u.jsx(we,{elevation:n>=c?4:1,children:u.jsx(at,{completedSubtopics:V(c),totalSubtopics:pe(c),isAllSubtaskDone:k(c),event:f,index:c,buttonState:n,handleExpandArticle:_,handleGoToSubArticleTest:x,handleGoToTestNow:j,successLevel:n})})},c+"history-timeline")},c+"TimelineCard")):u.jsx("div",{children:"data not found..."})})]})};export{ft as default};
